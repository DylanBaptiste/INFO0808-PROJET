---
title: "INFO0808: Visualisation de donnees"
author: "BAPTISTE Dylan  Gandossi Jean-Victor"
date: "25/03/2021"
output:
  slidy_presentation: default
  ioslides_presentation: default
  beamer_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library("ggplot2")
library("dplyr")
library("lubridate")
library("plotly")
library(leaflet)
library(leaflet.opacity)
library(viridisLite)
library(broom)

accidents <- read.csv("clean_datasets/accidents.csv", sep=',', header = TRUE)
anhr <- setNames(data.frame(table(accidents$an, accidents$hr)), c("an", "hr", "count"))
caracteristiques <- read.csv("clean_datasets/accidents.csv", sep=',', header = TRUE)
str(caracteristiques)
d1 <- setNames(data.frame(table(as.Date(paste(caracteristiques$an, caracteristiques$mois, caracteristiques$jour, sep='-')))),c("Date","Count"))
d1$day <- weekdays(as.Date(d1$Date))

d2 <- d1 %>%
  mutate(Mois=month(Date), Date = as.Date(paste(year(Date), month(Date), '01', sep = '-'))) %>%
  group_by(Date, Mois) %>%
  summarise(Count = sum(Count))

d3 <- d1 %>%
  mutate(Date = month(Date)) %>%
  group_by(Date) %>%
  summarise(Count = sum(Count))

d4 <- d1 %>%
  mutate(Mois=month(Date), Day=day(Date), p=paste(month(Date), day(Date)), Date = as.Date(paste(year(Date), month(Date), day(Date), sep = '-'))) %>%
  group_by(Day, Mois, p, Date) %>%
  summarise(Count = sum(Count))
d4 <- d4[ with(d4, order(Mois, Day)), ]

```

## R Markdown

This is an R Markdown presentation. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Slide with Bullets

- Bullet 1
- Bullet 2
- Bullet 3

## Slide with R Output

```{r cars, echo=TRUE}
plot_ly(anhr, x=~hr, y=~an, z=~count, type="heatmap")%>% layout(title = "Nombre d'accident en fonction de l'heure de l'annee de 2005 a 2019",xaxis = list(title="Heure"), yaxis = list(title="Annee"))
plot_ly(anhr, x=~hr, y=~an, z=~count, color=~an, type="scatter3d",  mode = 'lines', line = list(width = 30)) # osef de lui ?

```

## Slide with Plot

```{r pressure}
plot(pressure)
```

